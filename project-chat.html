<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI 工程工具链 — 基于 FastAPI + LangChain 的 LLM 应用工具链，集成日志追踪、指标监控与 Agent 编排，方便调试和复现">
    <title>AI 工程工具链 | blog</title>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/common.css">

    <style>
        /* project-chat.html 专有样式 */

        .cursor-dot, .cursor-outline {
            position: fixed; top: 0; left: 0;
            transform: translate(-50%, -50%);
            border-radius: 50%; z-index: 9999;
            pointer-events: none;
        }
        .cursor-dot { width: 8px; height: 8px; background: var(--accent); }
        .cursor-outline {
            width: 40px; height: 40px;
            border: 2px solid var(--primary);
            transition: width 0.2s, height 0.2s, background 0.2s;
        }
        body.hover-active .cursor-outline {
            width: 70px; height: 70px;
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--secondary);
            backdrop-filter: blur(2px);
        }

        .project-hero {
            padding: 2rem 0 3rem; text-align: center; position: relative;
        }
        .project-hero::after {
            content: ''; position: absolute; bottom: 0; left: 10%; right: 10%;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--border-color), transparent);
        }
        .hero-badge {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 6px 18px;
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 50px; color: var(--primary);
            font-size: 0.85rem; font-weight: 600; margin-bottom: 1.5rem;
        }
        .project-hero h1 {
            font-size: 3.2rem; margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text; color: transparent; line-height: 1.2;
        }
        .project-hero .subtitle {
            font-size: 1.15rem; color: #94a3b8;
            max-width: 750px; margin: 0 auto 2rem; line-height: 1.8;
        }
        .hero-tags { display: flex; gap: 0.7rem; justify-content: center; flex-wrap: wrap; margin-bottom: 2rem; }
        .hero-tags .tag {
            padding: 6px 16px; background: var(--glass-bg);
            border: 1px solid var(--border-color); border-radius: 20px;
            font-size: 0.85rem; transition: all 0.3s;
        }
        .hero-tags .tag:hover { border-color: var(--primary); background: rgba(59,130,246,0.1); }
        .hero-actions { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

        .btn { display: inline-flex; align-items: center; gap: 8px; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); }
        .btn-outline:hover { background: rgba(59,130,246,0.1); }

        .section-heading {
            font-size: 1.8rem; font-weight: 700; margin: 3.5rem 0 1.5rem;
            display: flex; align-items: center; gap: 12px;
        }
        .section-heading i { font-size: 1.4rem; color: var(--accent); }
        .section-heading::after {
            content: ''; flex: 1; height: 1px;
            background: linear-gradient(to right, var(--border-color), transparent);
            margin-left: 12px;
        }

        .card { margin: 1.5rem 0; }
        .card:hover { border-color: rgba(59,130,246,0.3); }

        .arch-diagram {
            background: rgba(15,23,42,0.9); border: 1px solid var(--border-color);
            border-radius: 16px; padding: 2.5rem; margin: 1.5rem 0; overflow-x: auto;
        }
        .arch-layers { display: flex; flex-direction: column; gap: 1.2rem; }
        .arch-layer {
            display: flex; align-items: center; gap: 1rem;
            padding: 1rem 1.5rem; border-radius: 12px; border-left: 3px solid;
            transition: all 0.3s;
        }
        .arch-layer:hover { transform: translateX(8px); }
        .arch-layer.api { background: rgba(59,130,246,0.08); border-color: var(--primary); }
        .arch-layer.agent { background: rgba(139,92,246,0.08); border-color: var(--secondary); }
        .arch-layer.observe { background: rgba(6,182,212,0.08); border-color: var(--accent); }
        .arch-layer.infra { background: rgba(245,158,11,0.08); border-color: #f59e0b; }
        .arch-layer-icon {
            width: 42px; height: 42px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; flex-shrink: 0;
        }
        .api .arch-layer-icon { background: rgba(59,130,246,0.2); color: var(--primary); }
        .agent .arch-layer-icon { background: rgba(139,92,246,0.2); color: var(--secondary); }
        .observe .arch-layer-icon { background: rgba(6,182,212,0.2); color: var(--accent); }
        .infra .arch-layer-icon { background: rgba(245,158,11,0.2); color: #f59e0b; }
        .arch-layer-content h4 { font-size: 1rem; margin-bottom: 0.25rem; }
        .arch-layer-content p { font-size: 0.85rem; color: #94a3b8; }
        .arch-arrow { text-align: center; font-size: 1.2rem; color: #475569; margin: -0.4rem 0; }

        .feature-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.2rem; margin: 1.5rem 0;
        }
        .feature-item {
            background: var(--glass-bg); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 1.5rem; transition: all 0.3s;
        }
        .feature-item:hover { transform: translateY(-4px); border-color: var(--accent); }
        .feature-item i { font-size: 1.8rem; margin-bottom: 0.8rem; display: block; }
        .feature-item:nth-child(1) i { color: var(--primary); }
        .feature-item:nth-child(2) i { color: var(--accent); }
        .feature-item:nth-child(3) i { color: #10b981; }
        .feature-item:nth-child(4) i { color: #f59e0b; }
        .feature-item h3 { font-size: 1.05rem; margin-bottom: 0.4rem; }
        .feature-item p { font-size: 0.88rem; color: #94a3b8; line-height: 1.6; }

        .highlight-box {
            background: rgba(59,130,246,0.06); border: 1px solid rgba(59,130,246,0.2);
            border-radius: 12px; padding: 1.5rem 2rem; margin: 1.5rem 0;
        }
        .highlight-box h4 {
            color: var(--primary); margin-bottom: 0.8rem;
            display: flex; align-items: center; gap: 8px;
        }
        .highlight-box p, .highlight-box li { font-size: 0.92rem; color: #94a3b8; line-height: 1.7; }
        .highlight-box ul { list-style: none; margin-top: 0.5rem; }
        .highlight-box li { padding: 0.3rem 0 0.3rem 1.5rem; position: relative; }
        .highlight-box li::before { content: '\2192'; position: absolute; left: 0; color: var(--primary); }

        .back-section { text-align: center; padding: 3rem 0 5rem; }

        @media (max-width: 768px) {
            .project-hero h1 { font-size: 2rem; }
            .cursor-dot, .cursor-outline { display: none; }
        }
        @media (hover: hover) and (pointer: fine) {
            body { cursor: none; }
            body * { cursor: none; }
        }
    </style>
</head>
<body>
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>
    <canvas id="particles-canvas"></canvas>

    <nav>
        <div class="container">
            <div class="logo"><i class="fas fa-code"></i> blog</div>
            <ul class="nav-links">
                <li><a href="index.html" class="hover-target">首页</a></li>
                <li><a href="index.html#projects" class="hover-target">项目</a></li>
                <li><a href="index.html#blog" class="hover-target">博客</a></li>
                <li><a href="index.html#about" class="hover-target">关于</a></li>
                <li><a href="index.html#contact" class="hover-target">联系</a></li>
            </ul>
            <div class="hamburger" aria-label="菜单" role="button" tabindex="0">
                <span></span><span></span><span></span>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="breadcrumb">
            <a href="index.html" class="hover-target"><i class="fas fa-home"></i> 首页</a> /
            <a href="index.html#projects" class="hover-target">项目</a> /
            <span>AI 工程工具链</span>
        </div>

        <section class="project-hero">
            <div class="hero-badge">
                <i class="fas fa-bolt"></i> LLM 工程 · 个人实践
            </div>
            <h1>AI 工程工具链</h1>
            <p class="subtitle">
                围绕 LLM 应用的全链路工具链实践：
                <strong style="color: var(--accent);">FastAPI 做推理服务</strong>、
                <strong style="color: var(--secondary);">LangChain 编排 Agent</strong>、
                加上日志追踪和指标监控，方便调试和复现。
            </p>
            <div class="hero-tags">
                <span class="tag"><i class="fab fa-python"></i> Python</span>
                <span class="tag"><i class="fas fa-bolt"></i> FastAPI</span>
                <span class="tag"><i class="fas fa-link"></i> LangChain</span>
                <span class="tag"><i class="fas fa-chart-line"></i> Prometheus</span>
                <span class="tag"><i class="fas fa-search"></i> Jaeger</span>
                <span class="tag"><i class="fab fa-docker"></i> Docker Compose</span>
            </div>
            <div class="hero-actions">
                <a href="https://github.com/kokomi1234" class="btn hover-target" target="_blank">
                    <i class="fab fa-github"></i> 查看源码
                </a>
                <a href="index.html#projects" class="btn btn-outline hover-target">
                    <i class="fas fa-list"></i> 所有项目
                </a>
            </div>
        </section>

        <h2 class="section-heading"><i class="fas fa-layer-group"></i> 整体架构</h2>
        <div class="arch-diagram">
            <div class="arch-layers">
                <div class="arch-layer api">
                    <div class="arch-layer-icon"><i class="fas fa-bolt"></i></div>
                    <div class="arch-layer-content">
                        <h4>API 服务层 — FastAPI</h4>
                        <p>异步高性能推理接口，Pydantic 参数校验，自动 OpenAPI 文档</p>
                    </div>
                </div>
                <div class="arch-arrow">↕</div>
                <div class="arch-layer agent">
                    <div class="arch-layer-icon"><i class="fas fa-robot"></i></div>
                    <div class="arch-layer-content">
                        <h4>Agent 编排层 — LangChain</h4>
                        <p>Chain / Agent / Tool 三层抽象，支持 ReAct、Plan-and-Execute 等策略</p>
                    </div>
                </div>
                <div class="arch-arrow">↕</div>
                <div class="arch-layer observe">
                    <div class="arch-layer-icon"><i class="fas fa-eye"></i></div>
                    <div class="arch-layer-content">
                        <h4>可观测性层 — Traces + Metrics</h4>
                        <p>OpenTelemetry 自动注入 span，Prometheus 采集 token/latency/error 指标</p>
                    </div>
                </div>
                <div class="arch-arrow">↕</div>
                <div class="arch-layer infra">
                    <div class="arch-layer-icon"><i class="fab fa-docker"></i></div>
                    <div class="arch-layer-content">
                        <h4>基础设施层 — Docker Compose</h4>
                        <p>一键拉起 API + Jaeger + Prometheus + Grafana，开发环境秒启动</p>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-heading"><i class="fas fa-star"></i> 核心能力</h2>
        <div class="feature-grid">
            <div class="feature-item">
                <i class="fas fa-bolt"></i>
                <h3>FastAPI 推理服务</h3>
                <p>异步 ASGI 服务，流式返回 SSE，自带 /docs 交互文档，方便前端对接和测试。</p>
            </div>
            <div class="feature-item">
                <i class="fas fa-robot"></i>
                <h3>LangChain Agent 编排</h3>
                <p>通过 Tool 注册和 Prompt 模板实现灵活的 Agent 逻辑，支持多轮对话和工具调用。</p>
            </div>
            <div class="feature-item">
                <i class="fas fa-search"></i>
                <h3>分布式链路追踪</h3>
                <p>OpenTelemetry SDK 自动注入 trace_id / span_id，Jaeger 可视化调用链路和耗时。</p>
            </div>
            <div class="feature-item">
                <i class="fas fa-chart-line"></i>
                <h3>指标监控 & 告警</h3>
                <p>Prometheus 采集 token 用量、P95 延迟、错误率，Grafana 面板一目了然。</p>
            </div>
        </div>

        <h2 class="section-heading"><i class="fas fa-wrench"></i> 工程实践要点</h2>
        <div class="card">
            <p style="font-size: 1rem; color: #94a3b8; line-height: 1.8;">
                这个工具链并不是一个独立的产品，而是我在做 LLM 应用时沉淀下来的一套工程方法。
                主要解决三个痛点：<strong style="color: var(--text-color)">调试难</strong>（大模型中间过程不透明）、
                <strong style="color: var(--text-color)">复现难</strong>（随机性大、参数多）、
                <strong style="color: var(--text-color)">监控难</strong>（token 消耗和延迟不可控）。
            </p>
        </div>

        <div class="highlight-box">
            <h4><i class="fas fa-lightbulb"></i> 核心思路</h4>
            <ul>
                <li>所有 LLM 调用统一走 FastAPI 接口，方便加中间件做 trace 和计量</li>
                <li>LangChain 的 callback 机制天然支持 token 统计和 step 日志</li>
                <li>OpenTelemetry 自动插桩减少侵入性，trace 贯穿 API → Agent → Tool 调用</li>
                <li>Prometheus + Grafana 做实时监控，可按模型/接口/用户维度聚合</li>
                <li>Docker Compose 确保本地开发和 CI 环境一致，一条命令拉起全栈</li>
            </ul>
        </div>

        <div class="card">
            <h4 style="color: var(--accent); margin-bottom: 1rem; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-code"></i> 典型使用场景
            </h4>
            <p style="font-size: 0.92rem; color: #94a3b8; line-height: 1.8; margin-bottom: 1rem;">
                当一次 Agent 调用返回异常结果时，可以通过 Jaeger 查看完整调用链：
            </p>
            <div style="background: rgba(15,23,42,0.9); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem 2rem; font-family: 'Cascadia Code','Fira Code',monospace; font-size: 0.85rem; line-height: 2; color: #94a3b8; overflow-x: auto;">
                <span style="color: var(--primary); font-weight: 600;">POST /v1/chat</span> → trace_id: abc123<br>
                <span style="color: var(--accent);">├─ LangChain Agent.plan()</span> — 120ms<br>
                <span style="color: #f59e0b;">│  ├─ Tool: search_knowledge_base</span> — 85ms<br>
                <span style="color: #f59e0b;">│  └─ Tool: query_database</span> — 200ms ⚠️ 慢查询<br>
                <span style="color: #10b981;">├─ LLM: qwen-max</span> — 1.2s, tokens: 850<br>
                <span style="color: #10b981;">└─ Response</span> — 总耗时 1.6s
            </div>
        </div>

        <div class="back-section">
            <a href="index.html#projects" class="btn hover-target">
                <i class="fas fa-arrow-left"></i> 返回项目列表
            </a>
        </div>
    </div>

    <footer class="site-footer">
        <div class="container">
            <p><i class="fas fa-code"></i> 用工程化手段让 AI 落地</p>
            <p style="color: #475569; font-size: 0.9rem;">&copy; 2025 Zihui Zheng. Built with passion.</p>
        </div>
    </footer>

    <script src="js/common.js"></script>
    <script>
        const cursorDot = document.querySelector('.cursor-dot');
        const cursorOutline = document.querySelector('.cursor-outline');
        const isMobile = window.matchMedia("(max-width: 768px)").matches;

        if (!isMobile) {
            window.addEventListener('mousemove', (e) => {
                cursorDot.style.left = `${e.clientX}px`;
                cursorDot.style.top = `${e.clientY}px`;
                cursorOutline.animate(
                    { left: `${e.clientX}px`, top: `${e.clientY}px` },
                    { duration: 500, fill: "forwards" }
                );
            });
            document.querySelectorAll('.hover-target, a, button').forEach(el => {
                el.addEventListener('mouseenter', () => document.body.classList.add('hover-active'));
                el.addEventListener('mouseleave', () => document.body.classList.remove('hover-active'));
            });
        }
    </script>
</body>
</html>
